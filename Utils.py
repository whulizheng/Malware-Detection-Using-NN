import json
import numpy as np
import binascii
import os
from PIL import Image


def scan_file(file_dir):
    files = []
    for roo, dirs, file in os.walk(file_dir):
        files.append(file)
    return files


def getMatrixfrom_bin(filename, width):
    with open(filename, 'rb') as f:
        content = f.read()
    hexst = binascii.hexlify(content)  # 将二进制文件转换为十六进制字符串
    fh = np.array([int(hexst[i:i+2], 16)
                   for i in range(0, len(hexst), 2)])  # 按字节分割
    rn = len(fh)//width
    fh = np.reshape(fh[:rn*width], (-1, width))  # 根据设定的宽度生成矩阵
    fh = np.uint8(fh)
    return fh


def getIMGfrom_matrix(matrix):
    im = Image.fromarray(matrix)  # 转换为图像
    return im


def readjson(address):
    with open(address, 'r') as load_f:
        load_dict = json.load(load_f)
    return load_dict
